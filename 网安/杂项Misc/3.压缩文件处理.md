# 压缩文件处理

[TOC]

## 一. 压缩文件分析

### 1.1 伪加密

> 伪加密就是在对应的加密标志位做修改，进而再打开文件时识被别为加密压缩包。RAR文件块的HEAD_FLAGS和ZIP的核心目录区的通用位标记，这两个就是伪加密的切入点。当拿到文件时，如果压缩文件是加密的，或文件头正常但缺无法正常解压，可先考虑是否为伪加密。通过将标志位修改为0便可解密压缩包

zip：

用010editor打开压缩文件，找到文件头第九第十个字符，将其修改为0000

打开文件搜索十六进制504B0102，可以看到每个加密文件的文件头字段 ，从50开始计算，第九第十字符为加密字段，将其设置为0000即可变成无加密状态

rar：

rar由于有头部校验，使用伪加密打开文件时会报错，修改标志位后报消失且正常解压，说明是伪加密。

打开rar文件，找到第24个字节，字节尾数为4表示加密，0表示无加密

### 1.2 暴力破解

通常使用ARCHPR.exe工具破解zip文件，注意攻击类型的选择，常用暴力或者掩码（123？？？）（已知前几位）

### 1.3 明文攻击

已知加秘zip中部分文件的明文内容，利用这些内容推测出密钥并解密zip文件，相比暴力破解效率更高